## CHỦ ĐỀ F. GIẢI QUYẾT VẤN ĐỀ VỚI SỰ TRỢ GIÚP CỦA MÁY TÍNH
## THỰC HÀNH TẠO VÀ KHAI THÁC CƠ SỞ DỮ LIỆU

# BÀI 2
# TẠO BẢNG TRONG CƠ SỞ DỮ LIỆU

### Học xong bài này, em sẽ:

- Biết được cách tạo bảng theo thiết kế.
- Biết được sơ bộ cách thiết lập một số thuộc tính kiểu dữ liệu thường dùng.
- Tạo được một số bảng CSDL.

Thư viện trường em lưu trữ những gì và hàng ngày phục vụ những ai?

# 1 Các bảng trong cơ sở dữ liệu thư viện trường

### a) Các cột trong bảng

Một bảng CSDL có nhiều cột. Mỗi cột chứa dữ liệu thuộc một kiểu nhất định. Cần thiết lập kiểu dữ liệu cho mỗi cột trong bảng phù hợp với thực tế và mục đích sử dụng.

Bảng 1. Một số kiểu dữ liệu thường dùng trong Access

| Tên kiểu | Mô tả | Kích thước | Giải thích thêm |
|---|---|---|---|
| Short Text | Xâu kí tự ngắn | Không quá 255 kí tự | Một mục dữ liệu chữ |
| Long Text | Văn bản dài hơn | Tới 63 999 kí tự | Văn bản mô tả, giải thích thêm,... |
| Number | Số để tính toán | 1, 2, 4, 8 byte | Trong các công thức, các hàm tính toán |
| Date/Time | Thời gian | 8 byte | Cho các năm: 1900 - 9999 |
| Currency | Số tiền | 8 byte | Có thể có tới 1 đến 4 chữ số phần thập phân |
| AutoNumber | Số được Access sinh tự động | 4 byte | Tăng căn hoặc ngẫu nhiên khi thêm một bản ghi vào bảng |
| Yes/No | Chỉ nhận 1 trong 2 giá trị | 1 bit | Yes/No, True/False, On/Off |

### b) Thiết kế các bảng

Trong tin học, logic nghiệp vụ (Business Logic) hàm ý các quy tắc nghiệp vụ trong thế giới thực và người thiết kế CSDL cần dựa vào đó để xác định cách thu thập, lưu trữ và thao tác dữ liệu.

Hoạt động hằng ngày của thư viện trường liên quan đến kho sách, đến bạn đọc là các học sinh trong trường, đến các giao dịch mượn, trả sách. CSDL thư viện đơn giản nhất gồm 3 bảng tương ứng: *Sách, Bạn Đọc, Mượn-Trả sách*.

Bảng *Mượn-Trả* là bảng nối, một kiểu bảng riêng, sẽ được thiết kế sau. Dưới đây trình bày chi tiết về bảng *Sách* và bảng *Bạn Đọc*.

Bảng *Sách* gồm các cột và kiểu dữ liệu tương ứng như Bảng 2:

Bảng 2. Các trường dữ liệu trong bảng Sách

| STT | Tên trường | Kiểu dữ liệu | Chú thích |
|---|---|---|---|
| 1 | Mã sách | Short Text | Do thư viện đặt, là khoá chính; có thể hạn chế độ dài |
| 2 | Tên sách | Short Text | Cần có |
| 3 | Sẵn có | Yes/No | Cần có |
| 4 | Số trang | Number | Tuỳ chọn |
| 5 | Tác giả | Short Text | Tuỳ chọn |
| 6 | Loại sách | Short Text | Tuỳ chọn |

Có thể thêm một số cột nữa cho bảng *Sách* tuỳ theo yêu cầu quản lí và quy mô kho sách. Với mục đích minh hoạ, ta thêm cột *Loại sách*, phân loại sách Tin học “TI” và còn lại là sách “Khác”.

### c) Hướng dẫn tạo bảng theo thiết kế

Xét hai trường hợp:
- CSDL trống ta sẽ có sẵn ngay một bảng tên là Table1 theo mặc định.
- CSDL đang làm việc: Nháy chuột chọn Create\Table sẽ tạo thêm một bảng mới tên là Table1.

Access sẽ yêu cầu đổi tên Table1 thành tên mới khi ghi lưu bảng mới hoặc ta có thể gõ nhập luôn tên mới cho bảng trước khi nháy lệnh Create. Nên chọn tên gọi nhờ nội dung bảng chứa dữ liệu gì.

Thiết lập kiểu dữ liệu cho mỗi trường và các thuộc tính chi tiết
Mở bảng trong khung nhìn thiết kế và nhập lần lượt các tên trường trong cột Field Name. Access tự động tạo ra cột ID, và cột Data Type được dùng để chọn kiểu dữ liệu của trường.

Bước 1. Nháy chuột vào ô tên kiểu dữ liệu (cột Data Type), nháy dấu trỏ xuống ở đầu mút phải sẽ thả xuống danh sách để chọn các kiểu dữ liệu.

Bước 2. Chọn một kiểu dữ liệu (bằng tiếng Anh) thích hợp trong danh sách.

Vùng Field Properties bên dưới để xác định chi tiết các thuộc tính của kiểu dữ liệu đã chọn. Cột đầu tiên là danh sách các tên thuộc tính: Field Size, Format, Input Mask,.... Cột kế tiếp xác định cụ thể giá trị của thuộc tính.

Bước 3. Thiết lập các chi tiết thuộc tính của trường đã chọn:

1) Nháy chuột chọn một thuộc tính (một dòng) sẽ xuất hiện dấu trỏ xuống ở đầu mút phải.

2) Nháy dấu trỏ xuống để thả danh sách chọn thiết lập chi tiết cho thuộc tính đó. Các trường *Mã sách, Số thẻ* được dự kiến làm khoá chính trong các bảng tương ứng. Theo mặc định, trường khoá chính sẽ được xác định một số thuộc tính như sau: Required: Yes; Indexed: Yes (No Duplicates).

Thuộc tính Indexed (được lập chỉ mục) giúp tìm kiếm nhanh hơn. Một việc hay làm là tìm kiếm bạn đọc theo tên. Đối với cột Tên trong bảng *Bạn Đọc* nên xác định thuộc tính Indexed. Tuy nhiên, việc hai người trùng tên có thể xảy ra, nên ta phải chọn Indexed: Yes (Duplicates OK).

Cần căn cứ vào các tính chất định dạng của trường để hiển thị dữ liệu dưới dạng quen thuộc để xem và để gõ nhập dữ liệu mới. Với trường Ngày sinh của *Bạn Đọc*, kiểu dữ liệu Date/Time có các lựa chọn: General Date, Long Date, Medium Date, Short Date. Hãy chọn sao cho phù hợp.

## Tóm tắt bài học

- Các việc cần làm sau khi tạo bảng mới:
- Mở khung nhìn thiết kế để nhập các tên cột, chọn kiểu dữ liệu cho cột.
- Xác định một số thuộc tính chi tiết quan trọng của cột trong trường hợp cần thiết: Field Size, Required, Indexed và Yes/No Duplicates,...
- Chọn cột làm khoá chính của bảng.
- Chuyển sang khung nhìn bảng dữ liệu và thử nhập dữ liệu để kiểm tra.
