## CHỦ ĐỀ F. ICT
## GIẢI QUYẾT VẤN ĐỀ VỚI SỰ TRỢ GIÚP CỦA MÁY TÍNH
## THỰC HÀNH TẠO VÀ KHAI THÁC CƠ SỞ DỮ LIỆU

# BÀI 3
# LIÊN KẾT CÁC BẢNG TRONG CƠ SỞ DỮ LIỆU

### Học xong bài này, em sẽ:

- Biết được cách thiết lập/dẫn mối quan hệ giữa các bảng trong một CSDL để kết nối dữ liệu giữa hai bản ghi từ hai bảng.
- Tạo được CSDL có nhiều bảng.
- Thiết lập được quan hệ giữa các bảng.

Khi một bạn đọc mượn sách, thủ thư cần ghi lại những thông tin gì? Có một bảng nào trong CSDL chứa đầy đủ những thông tin này hay không?

# 1 Thiết lập mối quan hệ giữa hai bảng

### a) Các lựa chọn kết nối dữ liệu

Thiết lập mối quan hệ giữa hai bảng nhằm mục đích nối (join) dữ liệu giữa hai bản ghi tương ứng trong mỗi bảng. Access sẽ so khớp giá trị của hai trường được liên kết khi truy vấn dữ liệu hay kiểm tra hợp lệ khi nhập dữ liệu. Ví dụ, không thể có một người mượn mà chưa có thẻ thư viện; không thể mượn cuốn sách còn chưa có trong kho sách.

Quan hệ 1–∞ phổ biến nhất giữa hai bảng có ba lựa chọn thuộc tính của phép nối dữ liệu (Join Properties). Khi truy vấn lấy dữ liệu có yêu cầu nối các bản ghi từ hai bảng thì trong số các bản ghi đã thoả mãn điều kiện cần biết cách “nối” cụ thể.

1: Chỉ nối các bản ghi nếu các giá trị trường được kết nối trùng khớp nhau. Đây là phép nối trong (Inner join).

2: Lấy tất cả các bản ghi trong bảng bên trái nhưng chỉ nối với các bản ghi của bảng bên phải khớp giá trị trong trường được kết nối. Đây là phép nối ngoài bên trái (Left outer join).

### b) Thao tác thiết lập, chỉnh sửa, xoá mối quan hệ giữa hai bảng

Chọn Database Tools\Relationships để mở vùng làm việc với các mối quan hệ. Access hiển thị trực quan mối quan hệ giữa hai bảng bằng một đoạn thẳng nối hai bảng, ghi kèm các cặp số 1 – 1 hay 1 – ∞ ở hai đầu đoạn nối nếu đã được thiết lập rõ ràng. Chú ý rằng một bảng có thể liên kết với nhiều bảng khác.

# 2 Cột dữ liệu từ tra cứu

Sử dụng cột dữ liệu từ tra cứu giúp người dùng có thể chọn mục dữ liệu từ một danh sách thay cho gõ nhập. Việc nhập dữ liệu sẽ nhanh hơn và đảm bảo toàn vẹn tham chiếu.

## Tóm tắt bài học

- Các thao tác thiết lập, chỉnh sửa, xoá mối quan hệ giữa hai bảng trong CSDL bắt đầu bằng chọn Database Tools\Relationships để mở vùng làm việc với các mối quan hệ.
- Thiết lập kiểu dữ liệu từ tra cứu sẽ đảm bảo toàn vẹn tham chiếu.
- Kéo thả trường khoá ngoại của bảng con vào trường khoá chính của bảng mẹ để tạo quan hệ giữa hai bảng.
- Chọn thuộc tính cho phép nối dữ liệu trong hộp thoại Join Properties.
