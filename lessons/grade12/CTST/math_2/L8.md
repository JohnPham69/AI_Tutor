# Bài 2. Công thức xác suất toàn phần và công thức Bayes

Từ khoá: **Công thức xác suất toàn phần; Công thức Bayes.**


Một loại xét nghiệm nhanh SARS-CoV-2 cho kết quả dương tính với 76,2% các ca thực sự nhiễm virus và kết quả âm tính với 99,1% các ca thực sự không nhiễm virus (nguồn: https://tapchiyhocvietnam.vn/index.php/vmj/article/view/2124/1921). Giả sử tỉ lệ người nhiễm virus SARS-CoV-2 trong một cộng đồng là 1%. Một người trong cộng đồng đó làm xét nghiệm và nhận được kết quả dương tính. Hỏi khả năng người đó thực sự nhiễm virus là cao hay thấp?


## 1. Công thức xác suất toàn phần

Chị An trả lời hai câu hỏi. Xác suất trả lời đúng câu hỏi thứ nhất là 0,7. Xác suất trả lời đúng câu hỏi thứ hai là 0,9 nếu chị An trả lời đúng câu hỏi thứ nhất và là 0,5 nếu chị An không trả lời đúng câu hỏi thứ nhất.

Gọi A là biến cố "Chị An trả lời đúng câu hỏi thứ nhất" và B là biến cố "Chị An trả lời đúng câu hỏi thứ hai".

Hãy tìm các giá trị thích hợp điền vào các ? ở sơ đồ hình cây sau:

| Câu hỏi thứ nhất | Câu hỏi thứ hai | Kết quả | Xác suất |
|---|---|---|---|
| 0,7 | B | AB | 0,63 |
| ? | B | AB | ? |
| ? | B | AB | ? |
| ? | B | AB | ? |

Ta thấy biến cố B là hợp của hai biến cố xung khắc AB và $\bar{A}B$. Do đó

$P(B) = P(AB) + P(\bar{A}B) = 0,63 + 0,15 = 0,78$.

Một cách tổng quát, ta có

Cho hai biến cố A và B với $0 < P(B) < 1$. Khi đó

$P(A) = P(B)P(A|B) + P(\bar{B})P(A|\bar{B})$

gọi là **công thức xác suất toàn phần**.


### Chú ý:

- Công thức xác suất toàn phần cũng đúng với biến cố B bất kì.

### Ví dụ 1. Trong , hãy tính xác suất người làm xét nghiệm có kết quả dương tính.

#### Giải

Gọi A là biến cố "Người làm xét nghiệm có kết quả qua dương tính" và B là biến cố "Người làm xét nghiệm thực sự nhiễm virus".

Do xét nghiệm cho kết quả dương tính với 76,2% các ca thực sự nhiễm virus nên $P(A|B) = 0,762$.

Do xét nghiệm cho kết quả âm tính với 99,1% các ca thực sự không nhiễm virus nên $P(\bar{A}|\bar{B}) = 0,991$. Suy ra

$P(A|\bar{B}) = 1 - P(\bar{A}|\bar{B}) = 1 - 0,991 = 0,009$.

Do tỉ lệ người nhiễm virus trong cộng đồng là 1% nên $P(B) = 0,01$ và $P(\bar{B}) = 0,99$.

Áp dụng công thức xác suất toàn phần, ta có xác suất người làm xét nghiệm có kết quả dương tính là

$P(A) = P(B)P(A|B) + P(\bar{B})P(A|\bar{B}) = 0,01 \cdot 0,762 + 0,99 \cdot 0,009 = 0,01653$.

Vào mỗi buổi sáng ở tuyến phố H, xác suất xảy ra tắc đường khi trời mưa và không mưa lần lượt là 0,7 và 0,2. Xác suất có mưa vào mỗi buổi sáng là 0,1. Tính xác suất để sáng đó tuyến phố H bị tắc đường.


## 2. Công thức Bayes

Khảo sát thị lực của 100 học sinh, ta thu được bảng số liệu sau:

| Thị lực | Giới tính |
|---|---|
| | Nữ | Nam |
| Có tật khúc xạ | 12 | 18 |
| Không có tật khúc xạ | 38 | 32 |

Chọn ngẫu nhiên 1 bạn trong 100 học sinh trên.

a) Biết rằng bạn đó có tật khúc xạ, tính xác suất bạn đó là học sinh nam.

b) Biết rằng bạn đó là học sinh nam, tính xác suất bạn đó có tật khúc xạ.

Hàng số liệu trên được gọi là bảng số liệu 2 x 2.

Từ bảng số liệu, ta thấy có 50 học sinh nam và 50 học sinh nữ tham gia khảo sát, trong đó có $12 + 18 = 30$ học sinh có tật khúc xạ và $38 + 32 = 70$ học sinh không có tật khúc xạ.

Gọi A là biến cố "Học sinh được chọn bị tật khúc xạ" và B là biến cố "Học sinh được chọn là nữ". Từ bảng số liệu trên, ta tính được các xác suất sau:

$P(A) = \frac{12+18}{100} = 0,3$; $P(B) = \frac{12+38}{100} = 0,5$; $P(A \cap B) = \frac{12}{100} = 0,12$.

Hơn nữa, ta cũng tính được các xác suất có điều kiện sau:

$P(A|B) = \frac{12}{38} \approx 0,316$; $P(B|A) = \frac{12}{18} \approx 0,667$.

Từ đây suy ra

$P(B|A) = \frac{P(A \cap B)}{P(A)} = \frac{0,12}{0,3} = 0,4$.

và

$P(A|B) = \frac{P(A \cap B)}{P(B)} = \frac{0,12}{0,5} = 0,24$.

Một cách tổng quát, từ định nghĩa xác suất có điều kiện với $P(A) > 0$, ta có

$P(B|A) = \frac{P(A \cap B)}{P(A)}$.

Kết hợp công thức trên với công thức xác suất toàn phần, ta có:

Giả sử A và B là hai biến cố ngẫu nhiên thoả mãn $P(A) > 0$ và $0 < P(B) < 1$. Khi đó,

$P(B|A) = \frac{P(B)P(A|B)}{P(B)P(A|B) + P(\bar{B})P(A|\bar{B})}$

gọi là **công thức Bayes**.


### Chú ý:

a) Công thức Bayes vẫn đúng với biến cố B bất kì.

b) Với $P(A) > 0$, công thức $P(B|A) = \frac{P(B)P(A|B)}{P(A)}$ cũng được gọi là công thức Bayes.

c) Trong trường hợp tổng quát, người ta chứng minh được rằng với A, B là hai biến cố bất kì thì $P(A|B) = \frac{P(B)P(A|B)}{P(B)P(A|B) + P(\bar{B})P(A|\bar{B})}$.

### Ví dụ 2. Một nhà máy có hai phân xưởng I và II. Phân xưởng I sản xuất 40% số sản phẩm và phân xưởng II sản xuất 60% số sản phẩm. Tỉ lệ sản phẩm bị lỗi của phân xưởng I là 2% và của phân xưởng II là 1%. Kiểm tra ngẫu nhiên 1 sản phẩm của nhà máy.

a) Tính xác suất để sản phẩm đó bị lỗi.

b) Biết rằng sản phẩm được kiểm tra bị lỗi. Hỏi xác suất sản phẩm đó do phân xưởng nào sản xuất cao hơn?

#### Giải

a) Gọi A là biến cố "Sản phẩm được kiểm tra bị lỗi" và B là biến cố "Sản phẩm được kiểm tra do phân xưởng I sản xuất".

Do phân xưởng I sản xuất 40% số sản phẩm và phân xưởng II sản xuất 60% số sản phẩm nên $P(B) = 0,4$ và $P(\bar{B}) = 1 - 0,4 = 0,6$.

Do tỉ lệ sản phẩm bị lỗi của phân xưởng I là 2% và của phân xưởng II là 1% nên

$P(A|B) = 0,02$ và $P(A|\bar{B}) = 0,01$.

Xác suất để sản phẩm được kiểm tra bị lỗi là

$P(A) = P(B)P(A|B) + P(\bar{B})P(A|\bar{B}) = 0,4 \cdot 0,02 + 0,6 \cdot 0,01 = 0,014$.

b) Nếu sản phẩm được kiểm tra bị lỗi thì xác suất sản phẩm đó do phân xưởng I sản xuất là

$P(B|A) = \frac{P(B)P(A|B)}{P(A)} = \frac{0,4 \cdot 0,02}{0,014} = \frac{4}{7}$.

Nếu sản phẩm được kiểm tra bị lỗi thì xác suất sản phẩm đó do phân xưởng II sản xuất là

$P(\bar{B}|A) = 1 - P(B|A) = \frac{3}{7}$.

Vậy nếu sản phẩm được kiểm tra bị lỗi thì xác suất sản phẩm đó do phân xưởng I sản xuất cao hơn xác suất sản phẩm đó do phân xưởng II sản xuất.

### Ví dụ 3. Trong , một người làm xét nghiệm và nhận được kết quả dương tính. Tính xác suất người đó thực sự nhiễm virus (kết quả làm tròn đến hàng phần nghìn).

#### Giải

Sử dụng kí hiệu của các biến cố ở Ví dụ 1.

Xác suất người thực sự nhiễm virus khi người đó có kết quả xét nghiệm dương tính là $P(B|A)$. Ta có

$P(B|A) = \frac{P(B)P(A|B)}{P(A)} = \frac{0,01 \cdot 0,762}{0,01653} \approx 0,461 = 46,1\%$.

Khi phát hiện một vật thể bay, xác suất một hệ thống radar phát cảnh báo là 0,9 nếu vật thể bay đó là mục tiêu thật và là 0,05 nếu đó là mục tiêu giả. Có 99% các vật thể bay là mục tiêu giả. Biết rằng hệ thống radar đang phát cảnh báo khi phát hiện một vật thể bay. Tính xác suất vật thể đó là mục tiêu thật.

Người ta điều tra thấy ở một địa phương nọ có 2% tài xế sử dụng điện thoại di động khi lái xe. Trong các vụ tai nạn ở địa phương đó, người ta nhận thấy có 10% là do tài xế có sử dụng điện thoại khi lái xe gây ra. Hỏi việc sử dụng điện thoại di động khi lái xe làm tăng xác suất gây tai nạn bao nhiêu lần?


## 3. Sơ đồ hình cây

Bạn Việt chuẩn bị đi tham quan một hòn đảo trong hai ngày thứ Bảy và Chủ nhật. Ở hòn đảo đó, mỗi ngày chỉ có nắng hoặc mưa, nếu một ngày là nắng thì khả năng xảy ra mưa ở ngày tiếp theo là 20%, còn nếu một ngày là mưa thì khả năng ngày hôm sau vẫn mưa là 30%. Theo dự báo thời tiết, xác suất trời sẽ nắng vào thứ Bảy là 0,7.

Hãy tìm các giá trị thích hợp thay vào sơ đồ hình cây sau:

Thứ Bảy
Nắng
Mưa

Chủ Nhật
Nắng
Mưa
Nắng
Mưa

Hướng dẫn:

Gọi A là biến cố "Ngày thứ Bảy trời nắng" và B là biến cố "Ngày Chủ nhật trời mưa".

Ta có $P(A) = 0,7$; $P(B|A) = 0,2$; $P(\bar{B}|A) = 0,3$.

Do đó $P(\bar{A}) = 1 - P(A) = 0,3$; $P(\bar{B}|\bar{A}) = 1 - P(B|\bar{A}) = 0,7$.

Áp dụng công thức nhân xác suất, ta có xác suất trời nắng vào thứ Bảy và trời mưa vào Chủ nhật là

$P(A \cap B) = P(A)P(B|A) = 0,7 \cdot 0,2 = 0,14$.

Tương tự, ta có

$P(A \cap \bar{B}) = P(A)P(\bar{B}|A) = 0,7 \cdot 0,8 = 0,56$;

$P(\bar{A} \cap B) = P(\bar{A})P(B|\bar{A}) = 0,3 \cdot 0,3 = 0,09$;

$P(\bar{A} \cap \bar{B}) = P(\bar{A})P(\bar{B}|\bar{A}) = 0,3 \cdot 0,7 = 0,21$.

Ta có thể biểu diễn các kết quả trên theo sơ đồ hình cây như sau:

| | Thứ Bảy | | Chủ Nhật | Kết quả | Xác suất |
|---|---|---|---|---|---|
| | 0,7 | A | 0,8 | $\bar{B}$ | $A\bar{B}$ | 0,56 |
| | | | 0,2 | B | $AB$ | 0,14 |
| | 0,3 | $\bar{A}$ | 0,3 | B | $\bar{A}B$ | 0,09 |
| | | | 0,7 | $\bar{B}$ | $\bar{A}\bar{B}$ | 0,21 |

Nhận xét: Trên sơ đồ hình cây:

- Xác suất của các nhánh trong sơ đồ hình cây từ đỉnh thứ hai là xác suất có điều kiện.

- Xác suất xảy ra của mỗi kết quả bằng tích các xác suất trên các nhánh của cây đi đến kết quả đó.

### Ví dụ 5. Ở một sân bay, người ta sử dụng một loại máy soi tự động phát hiện hàng cấm trong hành lí kí gửi. Máy phát chuông cảnh báo với 95% các kiện hành lí có chứa hàng cấm và 2% các kiện hành lí không chứa hàng cấm. Tỉ lệ các kiện hành lí có chứa hàng cấm là 0,1%.

Chọn ngẫu nhiên một kiện hành lí để soi bằng máy trên. Sử dụng sơ đồ hình cây, tính xác suất của các biến cố:

M: "Kiện hành lí có chứa hàng cấm và máy phát chuông cảnh báo";

N: "Kiện hành lí không chứa hàng cấm và máy phát chuông cảnh báo".

#### Giải

Gọi A là biến cố "Kiện hành lí có chứa hàng cấm" và B là biến cố "Máy phát chuông cảnh báo". Ta có

$P(B|A) = 0,95$; $P(B|\bar{A}) = 0,02$; $P(A) = 0,001$.

Do đó $P(\bar{A}) = 1 - P(A) = 0,999$; $P(\bar{B}|A) = 1 - P(B|A) = 0,05$; $P(\bar{B}|\bar{A}) = 1 - P(B|\bar{A}) = 0,98$.

Ta có sơ đồ hình cây như sau:

| | | | | Kết quả | Xác suất |
|---|---|---|---|---|---|
| | 0,001 | A | 0,95 | B | $AB$ | 0,00095 |
| | | | 0,05 | $\bar{B}$ | $A\bar{B}$ | 0,00005 |
| | 0,999 | $\bar{A}$ | 0,02 | B | $\bar{A}B$ | 0,01998 |
| | | | 0,98 | $\bar{B}$ | $\bar{A}\bar{B}$ | 0,97902 |

Do $M = A \cap B$ nên $P(M) = P(A \cap B) = 0,00095$.

Do $N = \bar{A} \cap \bar{B}$ nên $P(N) = P(\bar{A} \cap \bar{B}) = 0,97902$.

Hộp thứ nhất có 4 viên bi xanh và 6 viên bi đỏ. Hộp thứ hai có 5 viên bi xanh và 4 viên bi đỏ. Các viên bi có cùng kích thước và khối lượng. Lấy ra ngẫu nhiên 1 viên bi từ hộp thứ nhất chuyển sang hộp thứ hai. Sau đó lại lấy ra ngẫu nhiên 1 viên bi từ hộp thứ hai.

Sử dụng sơ đồ hình cây, tính xác suất của các biến cố:

A: "Viên bi lấy ra từ hộp thứ nhất có màu xanh và viên bi lấy ra từ hộp thứ hai có màu đỏ";

B: "Hai viên bi lấy ra có cùng màu".

Một trường đại học tiến hành khảo sát tình trạng việc làm sau khi tốt nghiệp của sinh viên. Kết quả khảo sát cho thấy tỉ lệ người tìm được việc làm đúng chuyên ngành là 85% đối với sinh viên tốt nghiệp loại giỏi và 70% đối với sinh viên tốt nghiệp loại khác.

Tỉ lệ sinh viên tốt nghiệp loại giỏi là 30%. Gặp ngẫu nhiên một sinh viên đã tốt nghiệp của trường.

Sử dụng sơ đồ hình cây, tính xác suất của các biển cố:

C: "Sinh viên tốt nghiệp loại giỏi và tìm được việc làm đúng chuyên ngành";

D: "Sinh viên không tốt nghiệp loại giỏi và tìm được việc làm đúng chuyên ngành".


## BÀI TẬP

1. Một thư viện có 35% tổng số sách là sách khoa học, 14% tổng số sách là sách khoa học tự nhiên. Chọn ngẫu nhiên một quyển sách của thư viện. Tính xác suất để quyển sách được chọn là sách khoa học tự nhiên, biết rằng đó là quyển sách về khoa học.

2. Cho hai biến cố A và B có $P(A) = 0,4$; $P(B) = 0,8$ và $P(A \cap B) = 0,5$. Tính $P(A|B)$ và $P(B|A)$.

3. Mỗi bạn học sinh trong lớp của Minh lựa chọn khoa học một trong hai ngoại ngữ là tiếng Anh hoặc tiếng Nhật. Xác suất chọn tiếng Anh của mỗi bạn học sinh nữ là 0,6 và của mỗi bạn học sinh nam là 0,7. Lớp của Minh có 25 bạn nữ và 20 bạn nam. Chọn ra ngẫu nhiên một bạn trong lớp.

    Sử dụng sơ đồ hình cây, tính xác suất của các biến cố:

    - A: "Bạn được chọn là nam và học tiếng Nhật";

    - B: "Bạn được chọn là nữ và học tiếng Anh".

4. Máy tính và thiết bị lưu điện (UPS) được kết nối như . Khi xảy ra sự cố điện, UPS bị hỏng với xác suất 0,02. Nếu UPS bị hỏng khi xảy ra sự cố điện, máy tính sẽ bị hỏng với xác suất 0,1; ngược lại, nếu UPS không bị hỏng, máy tính sẽ không bị hỏng.

    a) Tính xác suất để cả UPS và máy tính đều không bị hỏng khi xảy ra sự cố điện.

    b) Tính xác suất để cả UPS và máy tính đều bị hỏng khi xảy ra sự cố điện.
